<!--
  ~ Copyright (c) 2023 D2ArmorPicker by Mijago.
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as published
  ~ by the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License
  ~ along with this program.  If not, see <http://www.gnu.org/licenses/>.
  -->

<div style="display: flex; align-items: center; gap: 12px">
  <div class="custom-stat-slider" style="width: 350px; height: 30px">
    <div style="display: flex; align-items: flex-end; height: 100%; width: 100%; gap: 0">
      <ng-container *ngFor="let value of statValues">
        <div
          class="stat-line"
          [class.zero-line]="value === 0"
          [class.fifth-line]="value > 0 && value % 5 === 0"
          [class.tenth-line]="value > 0 && value % 10 === 0"
          [class.selected]="value === selectedValue"
          [class.disabled]="value > maximumAvailableTier * 10"
          [style.height]="value % 10 === 0 ? '16px' : value % 5 === 0 ? '12px' : '8px'"
          [matTooltip]="'Value: ' + value + (value % 10 === 0 ? ' (Tier ' + value / 10 + ')' : '')"
          [matTooltipDisabled]="value > maximumAvailableTier * 10"
          matTooltipPosition="above"
          [matTooltipShowDelay]="0"
          (click)="value <= maximumAvailableTier * 10 && setValueMob(value)"
          (mouseenter)="handleHover(value)"
          (mouseleave)="clearHover()">
        </div>
      </ng-container>
    </div>
  </div>
  <div class="stat-tier-value">
    <span
      *ngIf="!editingValue"
      (click)="editingValue = true"
      style="cursor: pointer; min-width: 32px; display: inline-block">
      {{ selectedValue }}
    </span>
    <input
      *ngIf="editingValue"
      #valueInput
      type="number"
      [min]="0"
      [max]="maximumAvailableTier * 10"
      [value]="selectedValue"
      (blur)="commitValueEdit(valueInput.value)"
      (keydown.enter)="commitValueEdit(valueInput.value)"
      (keydown.escape)="cancelValueEdit()"
      style="
        width: 40px;
        text-align: center;
        border: none;
        border-bottom: 1px solid #888;
        outline: none;
        background: transparent;
        font: inherit;
      " />
    / {{ maximumAvailableTier * 10 }}
    <div
      *ngIf="hoveredValue !== null && hoveredValue <= maximumAvailableTier * 10"
      class="hover-value-indicator">
      Hovering: {{ hoveredValue }}
    </div>
  </div>
  <button
    mat-icon-button
    (click)="toggleLockState()"
    matTooltip="Locking a stat enforces this stat to have exactly this value. Use this for example to get exact T3 of Mobility on a Titan.">
    <mat-icon *ngIf="!locked">lock_open</mat-icon>
    <mat-icon *ngIf="locked" class="lock-locked">lock</mat-icon>
  </button>
</div>
